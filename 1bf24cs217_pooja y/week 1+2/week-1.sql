show databases;
create database insurance2;
use insurance2;
create table person (driver_id varchar(50) primary key, name varchar(50), address varchar(50));
desc person;
create table car (reg_num varchar(10) primary key, model varchar(20), year int(4));
create table accident(report_num int(10), accidenht_date date, location varchar(50));
drop table accident;
create table accident(report_num int(10) primary key, accident_date date, location varchar(50));
create table owns(driver_id varchar(50), reg_num varchar(10), primary key(driver_id, reg_num), foreign key(driver_id) references person(driver_id), foreign key(reg_num) references car(reg_num));
create table participated(driver_id varchar(50), reg_num varchar(10), report_num int(10), damage_amount int(8), primary key(driver_id, reg_num), foreign key(driver_id) references person(driver_id), foreign key(reg_num) references car(reg_num), foreign key(report_num) references accident(report_num));
desc person;
desc car;
desc accident;
desc owns;
desc participated;
insert into person(driver_id,name,address) values('a01','richard','srinivas nagar');
insert into person(driver_id,name,address) values('a02','pradeep','rajajinagar');
insert into person(driver_id,name,address) values('a03','smith','ashok nagar');
insert into person(driver_id,name,address) values('a04','venu','n r colony');
insert into person(driver_id,name,address) values('a05','jhon','hanumanth nagar');
select * from person;
insert into car(reg_num,model,year) values('ka052250','indica',1990);
insert into car(reg_num,model,year) values('ka031181','lancer',1957);
insert into car(reg_num,model,year) values('ka095477','toyota',1998);
insert into car(reg_num,model,year) values('ka053408','honda',2008);
insert into car(reg_num,model,year) values('ka041702','audi',2005);
select * from car;
insert into owns(driver_id,reg_num) values('a01','ka052250');
insert into owns(driver_id,reg_num) values('a02','ka053408');
insert into owns(driver_id,reg_num) values('a03','ka031181');
insert into owns(driver_id,reg_num) values('a04','ka095477');
insert into owns(driver_id,reg_num) values('a05','ka041702');
select * from owns;
insert into accident(report_num,accident_Date,location) values(11,'2003-01-01','mysore road');
insert into accident(report_num,accident_Date,location) values(12,'2004-02-02','mysore road');
insert into accident(report_num,accident_Date,location) values(13,'2003-01-21','bull temple road');
insert into accident(report_num,accident_Date,location) values(14,'2008-02-17','mysore road');
insert into accident(report_num,accident_Date,location) values(15,'2005-03-04','kanakpura road');
select * from accident;
delete from accident where report_num=12;
select * from accident;
insert into accident(report_num,accident_Date,location) values(12,'2004-02-02','south end circle');
select * from accident;
insert into participated(driver_id,reg_num,report_num,damage_amount) values('a01','ka052250',11,10000);
insert into participated(driver_id,reg_num,report_num,damage_amount) values('a02','ka053408',12,50000);
insert into participated(driver_id,reg_num,report_num,damage_amount) values('a03','ka095477',13,25000);
insert into participated(driver_id,reg_num,report_num,damage_amount) values('a04','ka031181',14,3000);
insert into participated(driver_id,reg_num,report_num,damage_amount) values('a05','ka041702',15,5000);
select * from participated;
select accident_date,location from accident;
select driver_id from participated where damage_amount>=25000;
update participated set damage_amount=25000 where report_num=12;
select * from participated;
select * from car order by year asc;
select count(*) from accident where model='lancer';
select count(*) from accident;
select * from accident;
select count(*) from car where model='lancer';
select count(*) from car where year=2008;
select * from participated order by damage_amount desc;
select avg(damage_amount) from participated;
delete from participated where damage_amount<avg(damage_amount);
select * from participated where damage_amount<(select avg(damage_amount) from participated);
delete from participated where damage_amount<(select avg(damage_amount) from participated);
select * from person where driver_id=(select driver_id from participated where damage_amount > 13600);
select driver_id from participated where damage_amount > 13600;
select * from person where driver_id=(select driver_id from participated where damage_amount > 13600) group by name;
select distinct p.name as nae from person p where exists(select 1 from participated d where d.driver_id=p.driver_id and d.damage_amount>(select avg(damage_amount) from participated));
select distinct p.name as name from person p where exists(select * from participated d where d.driver_id=p.driver_id and d.damage_amount>(select avg(damage_amount) from participated));
select max(damage_amount) from participated;
select * from participated where damage_amount <(select avg(damage_amount) from participated);
delete from participated where damage_amount<(select avg(damage_amount) from participated);
create table participated2(driver_id varchar(50), reg_num varchar(10), report_num int(10), damage_amount int(8), primary key(driver_id, reg_num), foreign key(driver_id) references person(driver_id)on delete cascade on update cascade, foreign key(reg_num) references car(reg_num)on delete cascade on update cascade, foreign key(report_num) references accident(report_num)on delete cascade on update cascade);
insert into participated2(driver_id,reg_num,report_num,damage_amount) values('a01','ka052250',11,10000);
insert into participated2(driver_id,reg_num,report_num,damage_amount) values('a02','ka053408',12,25000);
insert into participated2(driver_id,reg_num,report_num,damage_amount) values('a03','ka095477',13,25000);
insert into participated2(driver_id,reg_num,report_num,damage_amount) values('a04','ka031181',14,3000);
insert into participated2(driver_id,reg_num,report_num,damage_amount) values('a05','ka041702',15,5000);
select * from participated2;
select * from participated2 where damage_amount <(select avg(damage_amount) from participated2);
delete from participated2 p where damage_amount<(select avg(damage_amount) from participated2);
select * from participated2 where damage_amount <(select avg(damage_amount) from participated2);
select * from insurance2.participated2 where damage_amount <(select * from(select avg(damage_amount) from insurance2.participated2) as i);
delete from insurance2.participated2 where damage_amount <(select * from(select avg(damage_amount) from insurance2.participated2) as i);
select * from participated2;
